{% extends "layout.html" %}

{% block title %}
    Sell
{% endblock %}

{% block main %}
    <form action="/sell" method="post">
        <div class="mb-3">
            <select id="symb" class="form-select mx-auto w-auto" name="symbol">
                <option disabled="" selected="">Symbol</option>

                {% for stock in stocklist %}
                    <option value="{{stock['symbol']}}">{{stock["symbol"]}}</option>
                {% endfor %}

            </select>
        </div>
        <div class="mb-3">
            <input id="shares" autocomplete="off" class="form-control mx-auto" name="shares" placeholder="Shares" min="0" type="number">
        </div>
        <button class="btn btn-primary" type="submit">Sell</button>
    </form>

    <script>
        let input = document.querySelector("#symb");
        let shares = document.querySelector("#shares");

        input.addEventListener('change', async function() {
            shares.value = "";

            console.log('You selected: ', this.value);
            let response = await fetch("/selloption?stock=" + input.value);
            console.log(response);
            let value = await response.json();
            console.log(value);

            shares = document.querySelector("#shares");
            shares.max = value;
        });

    </script>
{% endblock %}
